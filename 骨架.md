# 模块依赖关系

- rsws_bin 依赖 rsws_api, rsws_common, rsws_db
- rsws_api 依赖 rsws_service, rsws_model, rsws_common
- rsws_service 依赖 rsws_model, rsws_db, rsws_common
- rsws_model 依赖 rsws_common
- rsws_db 依赖 rsws_common

# 主要技术栈

## 后端技术栈
- Web框架: Salvo
- 数据库: PostgreSQL (sqlx)
- 缓存: Redis (deadpool-redis)
- 异步运行时: Tokio
- 邮件发送: lettre
- ID生成: Snowflake (rust-snowflake)
- 配置管理: config
- 序列化/反序列化: serde
- 错误处理: thiserror, anyhow
- 区块链交互: web3, tron-api
- PayPal交互: paypal-rs
- 高精度数值: bigdecimal

## 前端技术栈
- 框架: React 18 + TypeScript
- 构建工具: Vite
- UI组件库: Ant Design
- 路由: React Router v6
- 状态管理: Context API + useReducer
- HTTP客户端: Axios
- 样式: CSS Modules + Ant Design主题
- 测试: Jest + React Testing Library
- 代码规范: ESLint + Prettier

# 功能说明

## 用户功能

1. 账号管理
   - 注册、登录、找回密码
   - 个人资料管理
   - 安全设置（密码修改、二次验证等）
   - 钱包地址管理（添加/删除TRC20和ERC20地址）
   - PayPal账户关联管理 (新增)

2. 资源管理
   - 上传资源（文档、图片、视频等）
   - 设置资源访问权限和价格
   - 管理自己的资源（编辑、删除、统计）

3. 资源获取
   - 浏览资源列表（分类、标签、搜索）
   - 付费获取资源（阅读、下载）
   - 收藏和评价资源

4. 财务管理
   - 查看收入和支出明细
   - 提现申请
   - 充值
   - 查看USDT钱包总余额和各地址余额
   - 查看PayPal账户余额 (新增)
   - 查看佣金收入和支出
   - 跨平台资金转换（PayPal与USDT互转）(新增)

## 管理员功能

1. 用户管理
   - 用户列表查看和搜索
   - 用户状态管理（启用/禁用）
   - 用户权限管理
   - 用户等级和佣金比例管理

2. 资源管理
   - 资源审核
   - 资源分类和标签管理
   - 资源推荐和置顶

3. 系统配置
   - 网站基本信息配置
   - 邮件服务配置
   - 存储配置
   - 安全配置
   - 区块链接口配置
   - PayPal接口配置 (新增)

4. 支付管理
   - 支付渠道配置
   - 收款地址管理
   - 资金归集设置
   - 提现审核
   - USDT钱包监控
   - PayPal账户监控 (新增)
   - 佣金比例设置
   - 跨平台汇率设置 (新增)

5. 报表和统计
   - 用户增长统计
   - 资源使用统计
   - 交易额统计
   - 收入分析
   - 佣金分析
   - 跨平台交易分析 (新增)

6. 日志管理
   - 操作日志查询
   - 支付日志查询
   - 错误日志查询
   - 区块链交易日志查询
   - PayPal交易日志查询 (新增)


RSWS_V1/
├── Cargo.toml                # 工作区配置文件
├── config.toml              # 数据库/Redis等基础配置
├── rsws_api/                # API接口模块
│   ├── Cargo.toml           # API模块依赖配置
│   └── src/
│       ├── lib.rs           # API模块入口
│       ├── router.rs        # 路由配置
│       ├── user/            # 用户相关接口
│       │   ├── mod.rs       # 用户模块入口
│       │   ├── auth.rs      # 用户认证接口
│       │   ├── profile.rs   # 用户资料接口
│       │   ├── resource.rs  # 用户资源管理接口
│       │   ├── payment.rs   # 用户支付接口
│       │   ├── wallet.rs    # 用户钱包管理接口
│       │   └── paypal.rs    # 用户PayPal账户管理接口 (新增)
│       ├── admin/           # 管理员相关接口
│       │   ├── mod.rs       # 管理员模块入口
│       │   ├── auth.rs      # 管理员认证接口
│       │   ├── user_mgmt.rs # 用户管理接口
│       │   ├── resource_mgmt.rs # 资源管理接口
│       │   ├── config_mgmt.rs # 系统配置管理接口
│       │   ├── payment_mgmt.rs # 支付配置管理接口
│       │   ├── wallet_mgmt.rs # 钱包管理接口
│       │   ├── paypal_mgmt.rs # PayPal管理接口 (新增)
│       │   └── report.rs    # 报表查询接口
│       ├── resource.rs      # 资源（付费阅读/下载）接口
│       ├── order.rs         # 订单/支付接口
│       ├── request.rs       # 资源请求接口
│       ├── config.rs        # 配置接口
│       ├── webhook/         # Webhook接口 (新增)
│       │   ├── mod.rs       # Webhook模块入口
│       │   ├── paypal.rs    # PayPal Webhook接口
│       │   └── blockchain.rs # 区块链Webhook接口
│       └── log.rs           # 日志接口
├── rsws_service/            # 业务逻辑模块
│   ├── Cargo.toml           # 服务模块依赖配置
│   └── src/
│       ├── lib.rs           # 服务模块入口
│       ├── user/            # 用户服务
│       │   ├── mod.rs       # 用户服务入口
│       │   ├── auth_service.rs # 用户认证服务
│       │   ├── profile_service.rs # 用户资料服务
│       │   ├── resource_service.rs # 用户资源服务
│       │   ├── wallet_service.rs # 用户钱包服务
│       │   └── paypal_service.rs # 用户PayPal服务 (新增)
│       ├── admin/           # 管理员服务
│       │   ├── mod.rs       # 管理员服务入口
│       │   ├── auth.rs      # 管理员认证服务
│       │   ├── user_mgmt_service.rs # 用户管理服务
│       │   ├── resource_mgmt_service.rs # 资源管理服务
│       │   ├── wallet_mgmt_service.rs # 钱包管理服务
│       │   └── report_service.rs # 报表服务
│       ├── resource_service.rs # 资源业务逻辑
│       ├── order_service.rs # 订单业务逻辑
│       ├── payment_service.rs # 支付业务逻辑
│       ├── paypal_service.rs # PayPal交互服务 (新增)
│       ├── blockchain_service.rs # 区块链交互服务
│       ├── commission_service.rs # 佣金计算服务
│       ├── cross_platform_service.rs # 跨平台支付服务 (新增)
│       ├── request_service.rs # 请求业务逻辑
│       ├── config_service.rs # 配置业务逻辑
│       ├── webhook_service.rs # Webhook处理服务 (新增)
│       └── log_service.rs   # 日志业务逻辑
├── rsws_model/              # 数据模型模块
│   ├── Cargo.toml           # 模型模块依赖配置
│   └── src/
│       ├── lib.rs           # 模型模块入口
│       ├── user/            # 用户相关模型
│       │   ├── mod.rs       # 用户模型入口
│       │   ├── user.rs      # 普通用户模型
│       │   ├── admin.rs     # 管理员模型
│       │   ├── role.rs      # 角色权限模型
│       │   ├── profile.rs   # 用户资料模型
│       │   └── user_level.rs # 用户等级模型
│       ├── resource/        # 资源相关模型
│       │   ├── mod.rs       # 资源模型入口
│       │   ├── resource.rs  # 资源基本模型
│       │   ├── category.rs  # 资源分类模型
│       │   └── tag.rs       # 资源标签模型
│       ├── payment/         # 支付相关模型
│       │   ├── mod.rs       # 支付模型入口
│       │   ├── order.rs     # 订单模型
│       │   ├── transaction.rs # 交易记录模型
│       │   ├── wallet.rs    # 钱包模型
│       │   ├── wallet_address.rs # 钱包地址模型
│       │   ├── blockchain_tx.rs # 区块链交易记录模型
│       │   ├── paypal_account.rs # PayPal账户模型 (新增)
│       │   ├── paypal_transaction.rs # PayPal交易记录模型 (新增)
│       │   ├── cross_platform_tx.rs # 跨平台交易记录模型 (新增)
│       │   ├── commission.rs # 佣金配置模型
│       │   └── payment_config.rs # 支付配置模型
│       ├── request.rs       # 请求模型
│       ├── config/          # 配置相关模型
│       │   ├── mod.rs       # 配置模型入口
│       │   ├── system_config.rs # 系统配置模型
│       │   ├── email_config.rs # 邮件配置模型
│       │   ├── blockchain_config.rs # 区块链配置模型
│       │   ├── paypal_config.rs # PayPal配置模型 (新增)
│       │   └── payment_config.rs # 支付配置模型
│       ├── webhook/         # Webhook相关模型 (新增)
│       │   ├── mod.rs       # Webhook模型入口
│       │   ├── paypal_webhook.rs # PayPal Webhook模型
│       │   └── blockchain_webhook.rs # 区块链Webhook模型
│       └── log/             # 日志相关模型
│           ├── mod.rs       # 日志模型入口
│           ├── operation_log.rs # 操作日志模型
│           ├── payment_log.rs # 支付日志模型
│           └── error_log.rs # 错误日志模型
├── rsws_db/                 # 数据库操作模块
│   ├── Cargo.toml           # 数据库模块依赖配置
│   └── src/
│       ├── lib.rs           # 数据库模块入口
│       ├── postgres/        # PostgreSQL操作
│       │   ├── mod.rs       # PostgreSQL模块入口
│       │   ├── user.rs      # 用户数据操作
│       │   ├── resource.rs  # 资源数据操作
│       │   ├── payment.rs   # 支付数据操作
│       │   ├── wallet.rs    # 钱包数据操作
│       │   ├── paypal.rs    # PayPal数据操作 (新增)
│       │   ├── cross_platform.rs # 跨平台支付数据操作 (新增)
│       │   ├── commission.rs # 佣金数据操作
│       │   ├── config.rs    # 配置数据操作
│       │   ├── webhook.rs   # Webhook数据操作 (新增)
│       │   └── log.rs       # 日志数据操作
│       └── redis/           # Redis操作
│           ├── mod.rs       # Redis模块入口
│           ├── cache.rs     # 缓存操作
│           ├── api_key.rs   # 基于API Key的会话管理
│           └── rate_limit.rs # 限流操作
├── rsws_common/             # 公共功能模块
│   ├── Cargo.toml           # 公共模块依赖配置
│   └── src/
│       ├── lib.rs           # 公共模块入口
│       ├── config.rs        # 配置加载与管理
│       ├── error.rs         # 错误类型定义
│       ├── middleware/      # 中间件
│       │   ├── mod.rs       # 中间件入口
│       │   ├── auth.rs      # 认证中间件
│       │   ├── rate_limit.rs # 限流中间件
│       │   └── log.rs       # 日志中间件
│       └── utils/           # 工具函数
│           ├── mod.rs       # 工具模块入口
│           ├── email.rs     # 邮件发送
│           ├── id.rs        # ID生成
│           ├── response.rs  # 响应处理
│           ├── sign.rs      # 签名算法
│           ├── crypto.rs    # 加密解密
│           ├── blockchain.rs # 区块链交互工具
│           ├── paypal.rs    # PayPal交互工具 (新增)
│           ├── validation.rs # 数据验证
│           └── time.rs      # 时间处理
├── rsws_bin/                # 应用程序入口模块
│   ├── Cargo.toml           # 入口模块依赖配置
│   └── src/
│       └── main.rs          # 程序入口点
├── static/                  # 静态资源（如上传文件）
│   ├── uploads/             # 用户上传文件
│   ├── resources/           # 资源文件
│   └── public/              # 公共静态资源
├── sql/                     # 数据库建表脚本
│   ├── schema.sql           # 数据库表结构
│   ├── init_data.sql        # 初始化数据
│   └── migrations/          # 数据库迁移脚本
├── ui/                      # 前端项目
│   ├── user/                # 用户前端 (React + TypeScript)
│   │   ├── package.json     # 用户端依赖配置
│   │   ├── public/          # 公共静态资源
│   │   │   ├── index.html   # 主页面模板
│   │   │   ├── favicon.ico  # 网站图标
│   │   │   └── manifest.json # PWA配置
│   │   ├── src/             # 源代码目录
│   │   │   ├── index.tsx    # 应用入口文件
│   │   │   ├── App.tsx      # 根组件
│   │   │   ├── router/      # 路由配置
│   │   │   │   ├── index.tsx # 路由主配置
│   │   │   │   └── guards.tsx # 路由守卫
│   │   │   ├── store/       # 状态管理 (Context API)
│   │   │   │   ├── index.tsx # Store主配置
│   │   │   │   ├── AuthContext.tsx # 认证状态
│   │   │   │   ├── UserContext.tsx # 用户信息
│   │   │   │   ├── ResourceContext.tsx # 资源状态
│   │   │   │   ├── PaymentContext.tsx # 支付状态
│   │   │   │   └── WalletContext.tsx # 钱包状态
│   │   │   ├── api/         # API接口封装
│   │   │   │   ├── index.ts # API基础配置
│   │   │   │   ├── auth.ts  # 认证相关API
│   │   │   │   ├── user.ts  # 用户相关API
│   │   │   │   ├── resource.ts # 资源相关API
│   │   │   │   ├── payment.ts # 支付相关API
│   │   │   │   ├── wallet.ts # 钱包相关API
│   │   │   │   ├── paypal.ts # PayPal相关API
│   │   │   │   └── request.ts # 请求相关API
│   │   │   ├── components/  # 公共组件
│   │   │   │   ├── layout/  # 布局组件
│   │   │   │   │   ├── Header.tsx # 顶部导航
│   │   │   │   │   ├── Sidebar.tsx # 侧边栏
│   │   │   │   │   ├── Footer.tsx # 底部
│   │   │   │   │   ├── MainLayout.tsx # 主布局
│   │   │   │   │   └── Breadcrumb.tsx # 面包屑
│   │   │   │   ├── form/    # 表单组件
│   │   │   │   │   ├── LoginForm.tsx # 登录表单
│   │   │   │   │   ├── RegisterForm.tsx # 注册表单
│   │   │   │   │   ├── ProfileForm.tsx # 资料表单
│   │   │   │   │   ├── ResourceForm.tsx # 资源表单
│   │   │   │   │   ├── WalletForm.tsx # 钱包表单
│   │   │   │   │   └── PaymentForm.tsx # 支付表单
│   │   │   │   ├── display/ # 展示组件
│   │   │   │   │   ├── ResourceCard.tsx # 资源卡片
│   │   │   │   │   ├── ResourceList.tsx # 资源列表
│   │   │   │   │   ├── TransactionList.tsx # 交易列表
│   │   │   │   │   ├── WalletBalance.tsx # 钱包余额
│   │   │   │   │   ├── PayPalBalance.tsx # PayPal余额
│   │   │   │   │   └── CommissionChart.tsx # 佣金图表
│   │   │   │   ├── modal/   # 弹窗组件
│   │   │   │   │   ├── PaymentModal.tsx # 支付弹窗
│   │   │   │   │   ├── WithdrawModal.tsx # 提现弹窗
│   │   │   │   │   ├── DepositModal.tsx # 充值弹窗
│   │   │   │   │   ├── WalletModal.tsx # 钱包管理弹窗
│   │   │   │   │   └── PayPalModal.tsx # PayPal管理弹窗
│   │   │   │   └── common/  # 通用组件
│   │   │   │       ├── Loading.tsx # 加载组件
│   │   │   │       ├── Pagination.tsx # 分页组件
│   │   │   │       ├── SearchBox.tsx # 搜索框
│   │   │   │       ├── FileUpload.tsx # 文件上传
│   │   │   │       └── QRCode.tsx # 二维码组件
│   │   │   ├── views/       # 页面组件
│   │   │   │   ├── auth/    # 认证页面
│   │   │   │   │   ├── Login.tsx # 登录页
│   │   │   │   │   ├── Register.tsx # 注册页
│   │   │   │   │   ├── ForgotPassword.tsx # 忘记密码
│   │   │   │   │   └── ResetPassword.tsx # 重置密码
│   │   │   │   ├── dashboard/ # 仪表板
│   │   │   │   │   ├── Index.tsx # 主仪表板
│   │   │   │   │   ├── Profile.tsx # 个人资料
│   │   │   │   │   ├── Security.tsx # 安全设置
│   │   │   │   │   └── Notifications.tsx # 通知设置
│   │   │   │   ├── resource/ # 资源管理
│   │   │   │   │   ├── List.tsx # 资源列表
│   │   │   │   │   ├── Detail.tsx # 资源详情
│   │   │   │   │   ├── Upload.tsx # 上传资源
│   │   │   │   │   ├── Edit.tsx # 编辑资源
│   │   │   │   │   ├── MyResources.tsx # 我的资源
│   │   │   │   │   ├── Favorites.tsx # 收藏夹
│   │   │   │   │   └── Purchase.tsx # 购买页面
│   │   │   │   ├── wallet/  # 钱包管理
│   │   │   │   │   ├── Overview.tsx # 钱包概览
│   │   │   │   │   ├── Addresses.tsx # 地址管理
│   │   │   │   │   ├── Transactions.tsx # 交易记录
│   │   │   │   │   ├── Deposit.tsx # 充值页面
│   │   │   │   │   ├── Withdraw.tsx # 提现页面
│   │   │   │   │   ├── PayPalAccount.tsx # PayPal账户
│   │   │   │   │   ├── CrossPlatform.tsx # 跨平台转换
│   │   │   │   │   └── Commission.tsx # 佣金管理
│   │   │   │   ├── payment/ # 支付相关
│   │   │   │   │   ├── Orders.tsx # 订单列表
│   │   │   │   │   ├── OrderDetail.tsx # 订单详情
│   │   │   │   │   ├── PaymentHistory.tsx # 支付历史
│   │   │   │   │   └── Refunds.tsx # 退款记录
│   │   │   │   └── request/ # 请求管理
│   │   │   │       ├── List.tsx # 请求列表
│   │   │   │       ├── Create.tsx # 创建请求
│   │   │   │       ├── Detail.tsx # 请求详情
│   │   │   │       └── MyRequests.tsx # 我的请求
│   │   │   ├── types/       # TypeScript类型定义
│   │   │   │   ├── index.ts # 通用类型
│   │   │   │   ├── auth.ts  # 认证类型
│   │   │   │   ├── user.ts  # 用户类型
│   │   │   │   ├── resource.ts # 资源类型
│   │   │   │   ├── payment.ts # 支付类型
│   │   │   │   └── api.ts   # API类型
│   │   │   ├── utils/       # 工具函数
│   │   │   │   ├── auth.ts  # 认证工具
│   │   │   │   ├── format.ts # 格式化工具
│   │   │   │   ├── validation.ts # 验证工具
│   │   │   │   ├── crypto.ts # 加密工具
│   │   │   │   ├── payment.ts # 支付工具
│   │   │   │   └── constants.ts # 常量定义
│   │   │   ├── styles/      # 样式文件
│   │   │   │   ├── globals.css # 全局样式
│   │   │   │   ├── variables.css # CSS变量
│   │   │   │   ├── components.css # 组件样式
│   │   │   │   └── responsive.css # 响应式样式
│   │   │   └── assets/      # 静态资源
│   │   │       ├── images/  # 图片资源
│   │   │       ├── icons/   # 图标资源
│   │   │       └── fonts/   # 字体资源
│   │   ├── __tests__/       # 测试文件
│   │   │   ├── components/  # 组件测试
│   │   │   ├── utils/       # 工具函数测试
│   │   │   └── api/         # API测试
│   │   ├── .env             # 环境变量
│   │   ├── .env.development # 开发环境变量
│   │   ├── .env.production  # 生产环境变量
│   │   ├── vite.config.ts   # Vite配置
│   │   ├── tsconfig.json    # TypeScript配置
│   │   ├── eslint.config.js # ESLint配置
│   │   └── README.md        # 用户端说明文档

